# cyber_engine

# 核心

## AI模块插件 ：输入上下文构建

用户在进行输入的时候往往不会提及一些客观数据，比如当前时间，当前天气等。

所以我们可以重新构建大模型的输入，让他能够获取到更多客观性的数据，可以做出更智能的判断

我们还可以根据用户的输入，提取关键词然后在长期记忆数据库中进行查找，可以使大模型更加智能

除此之外，当用户询问道专有知识的时候，大模型是无法根据它自身的知识储备进行回答的，所以我们可以构建一个知识库，让大模型能够根据知识库进行回答

## AI模块插件 ：定时器

大模型在用于智能助理有一定的局限性，其中之一便是只能一问一答。例如：“在周五晚上给xxx发送一封邮件”
但是在周五晚上用户没有输入大模型自然不能完成对发送邮件功能的调用

而通过计时器插件可以使大模型在指定时间内进行一次相应输入，用来完成一些“无人值守”的任务，其实现方式是构建一个定时器插件,
这个插件会将定时任务写入到计划任务数据库中

在程序启动时会单独分出一个线程用于检查当前时间数据库是否有任务，如果有则使用scheduler角色构建输入传入到核心中处理

# 数据存储与检索

## 技术选型

我们采用的是lancedb进行向量数据库的构建，lancedb是一个基于向量的数据库，可以通过使用嵌入模型将文本转换为向量，然后存储在数据库中，当用户输入的时候，我们可以将用户的输入转换为向量，然后在数据库中进行查找，找到最相似的向量，然后将其对应的文本返回给用户

采用lancedb的优势是本地文件存储, 提高程序易用性和便捷性。嵌入式模型可以使用来自于BAI的开源嵌入模型或者采用openai的模型

我们将数据库与程序分离出来运行，对外暴露一系列的API接口，程序通过调用API接口来进行数据的存储与检索，方便管理员管理数据库以及节省每次进行数据存储与检索时重新读取模型的时间

## 长期记忆数据库

如果通过无限增加消息队列的方式来实现长期记忆数据库，会导致输入的数据量过大，要么超出了模型最大上下文限制，要么花费高额的成本
所以我们可以将出消息队列的数据存储到数据库中，然后通过数据库进行相似查找，这样可以减少大模型的输入，提高大模型的效率

## 知识库

知识库是一个存储专有知识的数据库，可以通过用户的输入来进行查找，然后返回给用户

知识库的构建方式是通过爬虫爬取一些专有知识的网站，然后将其存储到数据库中，当用户输入的时候，我们可以将用户的输入转换为向量，然后在数据库中进行查找，找到最相似的向量，然后将其对应的文本返回给用户

知识库的导入支持pdf，txt等常见格式的导入。我们采用开源项目marker将pdf转换为markdown格式，然后再将markdown格式的文件导入到数据库中，这样做可以提高知识库检索的准确性



